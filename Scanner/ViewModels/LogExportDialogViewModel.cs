using Microsoft.Toolkit.Mvvm.ComponentModel;
using Microsoft.Toolkit.Mvvm.DependencyInjection;
using Microsoft.Toolkit.Mvvm.Input;
using Scanner.Services;
using System.Collections.Generic;
using System.Threading.Tasks;

namespace Scanner.ViewModels
{
    public class LogExportDialogViewModel : ObservableObject
    {
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // DECLARATIONS /////////////////////////////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        private ILogService LogService = Ioc.Default.GetRequiredService<ILogService>();

        public AsyncRelayCommand ViewLoadedCommand;

        private List<Models.LogFile> _LogFiles;
        public List<Models.LogFile> LogFiles
        {
            get => _LogFiles;
            set => SetProperty(ref _LogFiles, value);
        }

        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // CONSTRUCTORS / FACTORIES /////////////////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        public LogExportDialogViewModel()
        {
            ViewLoadedCommand = new AsyncRelayCommand(LoadLogFiles);
        }

        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        // METHODS //////////////////////////////////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        private async Task LoadLogFiles()
        {
            LogFiles = await LogService.GetLogFiles();
        }
    }
}
